<!DOCTYPE html>
<html>
  <head>
    
    <title>Crunchy Data PostgreSQL Operator Documentation</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="generator" content="Hugo 0.55.6" />
<title>Multi-Zone Cloud Considerations :: Crunchy Data PostgreSQL Operator Documentation</title>
<link rel="shortcut icon" href="https://crunchydata.github.io/postgres-operator/latest/favicon.png" type="image/x-icon" />
<link href="https://crunchydata.github.io/postgres-operator/latest/css/nucleus.css" rel="stylesheet">
<link href="https://crunchydata.github.io/postgres-operator/latest/theme-flex/style.css" rel="stylesheet">

<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
<link href="https://crunchydata.github.io/postgres-operator/latest/css/Fort-Fonts.css" rel="stylesheet">
<link href="https://crunchydata.github.io/postgres-operator/latest/css/custom.css" rel="stylesheet">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
<script src="https://crunchydata.github.io/postgres-operator/latest/js/jquery-2.x.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.bundle.min.js" integrity="sha384-zDnhMsjVZfS3hiP7oCBRmfjkQC4fzxVxFhBx8Hkz2aZX8gEvA/jsP3eXRCvzTofP" crossorigin="anonymous"></script>
<script src="https://crunchydata.github.io/postgres-operator/latest/js/main.js"></script>
<script src="https://crunchydata.github.io/postgres-operator/latest/js/toc.js"></script>
<script type="text/javascript">
      var baseurl = "https:\/\/crunchydata.github.io\/postgres-operator\/latest";
</script>
<meta name="description" content="">



    
  </head>
  <body data-url="/advanced/multi-zone-design-considerations/">
    
      <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
  
<a class="navbar-brand" href="https://www.crunchydata.com/"><img alt="Crunchy Data" src="https://crunchydata.github.io/postgres-operator/latest/images/logo.svg"></a>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <ul class="navbar-nav mr-auto"></ul>
  <span class="navbar-text">
      <nav class="shortcuts">
              <li class="" role="">
                  <a href="https://github.com/CrunchyData/postgres-operator" target="_blank" rel="noopener">
                    <i class='fab fa-github'></i> <label>Source</label>
                  </a>
              </li>
              <li class="" role="">
                  <a href="https://kubernetes.io/docs/" target="_blank" rel="noopener">
                    <i class='fas fa-bookmark'></i> <label>Kubernetes</label>
                  </a>
              </li>
              <li class="" role="">
                  <a href="https://github.com/CrunchyData/postgres-operator/blob/master/LICENSE.md" target="_blank" rel="noopener">
                    <i class='fas fa-file-contract'></i> <label>License</label>
                  </a>
              </li>
      </nav>
  </span>
</nav>

<article>
  <aside>

    <ul class="menu">
      <div>
        <div class="searchbox">
          <input data-search-input id="search-by" type="text" placeholder="">
        </div>
        <script type="text/javascript" src="https://crunchydata.github.io/postgres-operator/latest/js/lunr.min.js"></script>
        <script type="text/javascript" src="https://crunchydata.github.io/postgres-operator/latest/js/auto-complete.js"></script>
        <link href="https://crunchydata.github.io/postgres-operator/latest/css/auto-complete.css" rel="stylesheet">
        <script type="text/javascript">
          
              var baseurl = "https:\/\/crunchydata.github.io\/postgres-operator\/latest";
          
        </script>
        <script type="text/javascript" src="https://crunchydata.github.io/postgres-operator/latest/js/search.js"></script>
      </div>

      <hr>
      <a class="baselink" href="https://crunchydata.github.io/postgres-operator/latest/">Crunchy Data PostgreSQL Operator Documentation</a>
      <hr>
        <b>Available Formats</b>
        <nav class="downloads">
                <li class="" role="">
                    <a href="https://crunchydata.github.io/postgres-operator/latest/pdf/postgres_operator.pdf" target="_blank" rel="noopener">
                      <i class='fas fa-file-pdf'></i> <label>PDF</label>
                    </a>
                </li>
                <li class="" role="">
                    <a href="https://crunchydata.github.io/postgres-operator/latest/epub/postgres_operator.epub" target="_blank" rel="noopener">
                      <i class='fas fa-book'></i> <label>EPUB</label>
                    </a>
                </li>
        </nav>
        <hr>

      <b>Navigation</b>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/quickstart/" class="dd-item
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/latest/quickstart/">Quickstart</a>

      </div>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/architecture/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/latest/architecture/">Architecture</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/architecture/overview/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/architecture/overview/">
            Overview
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/architecture/provisioning/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/architecture/provisioning/">
            Provisioning
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/architecture/disaster-recovery/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/architecture/disaster-recovery/">
            Disaster Recovery
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/architecture/high-availability/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/architecture/high-availability/">
            High-Availability
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/architecture/namespace/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/architecture/namespace/">
            Namespace Management
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/architecture/eventing/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/architecture/eventing/">
            Lifecycle Events
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/architecture/postgres-operator-containers-overview/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/architecture/postgres-operator-containers-overview/">
            PostgreSQL Containers
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/architecture/storage-overview/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/architecture/storage-overview/">
            Storage
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/architecture/users-role-overview/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/architecture/users-role-overview/">
            User &amp; Roles
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/configuration/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/latest/configuration/">Configuration</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/configuration/compatibility/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/configuration/compatibility/">
            Compatibility Requirements
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/configuration/configuration/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/configuration/configuration/">
            Configuration Resources
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/configuration/pgo-yaml-configuration/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/configuration/pgo-yaml-configuration/">
            PGO YAML
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/configuration/tls/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/configuration/tls/">
            TLS
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/installation/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/latest/installation/">Installation</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/installation/prereq/" class="dd-item
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/latest/installation/prereq/">Prerequisites</a>

      </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/installation/common-env/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/installation/common-env/">
            Operator Environment
          </a>
        </div>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/">Install Operator Using Ansible</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/prerequisites/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/prerequisites/">
            Prerequisites
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/installing-ansible/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/installing-ansible/">
            Installing Ansible
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/installing-operator/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/installing-operator/">
            Installing PostgreSQL Operator
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/installing-metrics/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/installing-metrics/">
            Installing Metrics Infrastructure
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/updating-operator/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/updating-operator/">
            Updating PostgreSQL Operator
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/uninstalling-operator/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/uninstalling-operator/">
            Uninstalling PostgreSQL Operator
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/uninstalling-metrics/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/installation/install-with-ansible/uninstalling-metrics/">
            Uninstalling Metrics Stack
          </a>
        </div>
    </li>
        </ul>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/installation/operator-install/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/installation/operator-install/">
            Install Operator Using Bash
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/installation/developer-setup/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/installation/developer-setup/">
            Developer Setup
          </a>
        </div>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/installation/install-pgo-client/" class="dd-item
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/latest/installation/install-pgo-client/">Install `pgo` Client</a>

      </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/">Using the pgo Client</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/common-tasks/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/common-tasks/">
            Common pgo Client Tasks
          </a>
        </div>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/">pgo Client Reference</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_apply/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_apply/">
            pgo apply
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_backup/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_backup/">
            pgo backup
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_benchmark/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_benchmark/">
            pgo benchmark
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_cat/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_cat/">
            pgo cat
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_clone/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_clone/">
            pgo clone
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_create/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_create/">
            pgo create
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_create_cluster/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_create_cluster/">
            pgo create cluster
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_create_namespace/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_create_namespace/">
            pgo create namespace
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_create_pgbouncer/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_create_pgbouncer/">
            pgo create pgbouncer
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_create_pgorole/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_create_pgorole/">
            pgo create pgorole
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_create_pgouser/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_create_pgouser/">
            pgo create pgouser
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_create_policy/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_create_policy/">
            pgo create policy
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_create_schedule/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_create_schedule/">
            pgo create schedule
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_create_user/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_create_user/">
            pgo create user
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_delete/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_delete/">
            pgo delete
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_delete_backup/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_delete_backup/">
            pgo delete backup
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_delete_benchmark/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_delete_benchmark/">
            pgo delete benchmark
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_delete_cluster/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_delete_cluster/">
            pgo delete cluster
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_delete_label/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_delete_label/">
            pgo delete label
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_delete_namespace/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_delete_namespace/">
            pgo delete namespace
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_delete_pgbouncer/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_delete_pgbouncer/">
            pgo delete pgbouncer
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_delete_pgorole/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_delete_pgorole/">
            pgo delete pgorole
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_delete_pgouser/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_delete_pgouser/">
            pgo delete pgouser
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_delete_policy/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_delete_policy/">
            pgo delete policy
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_delete_schedule/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_delete_schedule/">
            pgo delete schedule
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_delete_user/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_delete_user/">
            pgo delete user
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_df/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_df/">
            pgo df
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_failover/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_failover/">
            pgo failover
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_label/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_label/">
            pgo label
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_load/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_load/">
            pgo load
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_ls/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_ls/">
            pgo ls
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_reload/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_reload/">
            pgo reload
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_restore/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_restore/">
            pgo restore
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_scale/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_scale/">
            pgo scale
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_scaledown/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_scaledown/">
            pgo scaledown
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_show/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_show/">
            pgo show
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_show_backup/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_show_backup/">
            pgo show backup
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_show_benchmark/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_show_benchmark/">
            pgo show benchmark
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_show_cluster/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_show_cluster/">
            pgo show cluster
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_show_config/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_show_config/">
            pgo show config
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_show_namespace/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_show_namespace/">
            pgo show namespace
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_show_pgorole/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_show_pgorole/">
            pgo show pgorole
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_show_pgouser/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_show_pgouser/">
            pgo show pgouser
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_show_policy/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_show_policy/">
            pgo show policy
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_show_pvc/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_show_pvc/">
            pgo show pvc
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_show_schedule/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_show_schedule/">
            pgo show schedule
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_show_user/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_show_user/">
            pgo show user
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_show_workflow/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_show_workflow/">
            pgo show workflow
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_status/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_status/">
            pgo status
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_test/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_test/">
            pgo test
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_update/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_update/">
            pgo update
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_update_cluster/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_update_cluster/">
            pgo update cluster
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_update_namespace/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_update_namespace/">
            pgo update namespace
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_update_pgorole/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_update_pgorole/">
            pgo update pgorole
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_update_pgouser/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_update_pgouser/">
            pgo update pgouser
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_update_user/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_update_user/">
            pgo update user
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_upgrade/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_upgrade/">
            pgo upgrade
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_version/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_version/">
            pgo version
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_watch/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/pgo-client/reference/pgo_watch/">
            pgo watch
          </a>
        </div>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/security/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/latest/security/">RBAC Configuration</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/security/configure-postgres-operator-rbac/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/security/configure-postgres-operator-rbac/">
            Configuration of PostgreSQL Operator RBAC
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/security/install-postgres-operator-rbac/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/security/install-postgres-operator-rbac/">
            Installation of PostgreSQL Operator RBAC
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/security/api-encryption-configuration/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/security/api-encryption-configuration/">
            PostgreSQL Operator API Encryption Configuration
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/advanced/" class="dd-item parent haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/latest/advanced/">Advanced Topics</a>
            <i class="fas fa-angle-down fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/advanced/custom-config/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/advanced/custom-config/">
            Custom Configuration
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/advanced/custom-config-ssl/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/advanced/custom-config-ssl/">
            Custom SSL Configuration
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/advanced/multi-zone-design-considerations/" class="dd-item active">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/advanced/multi-zone-design-considerations/">
            Multi-Zone Cloud Considerations
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/advanced/direct-api-calls/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/advanced/direct-api-calls/">
            Rest API
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/upgrade/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/latest/upgrade/">Upgrade</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/upgrade/upgrade35/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/upgrade/upgrade35/">
            Upgrade PGO 3.5 Minor Versions
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/upgrade/upgrade35to4/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/upgrade/upgrade35to4/">
            Upgrade PGO 3.5 to 4.2.0
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/upgrade/upgrade4xto42_ansible/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/upgrade/upgrade4xto42_ansible/">
            Upgrade PGO 4.X to 4.2.0 (Ansible)
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/upgrade/upgrade4xto42_bash/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/upgrade/upgrade4xto42_bash/">
            Upgrade PGO 4.X to 4.2.0 (Bash)
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/upgrade/upgrade41/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/upgrade/upgrade41/">
            Upgrade PostgreSQL Operator 4.1 Minor Versions
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/upgrade/upgradeto35/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/upgrade/upgradeto35/">
            Upgrade to PGO 3.5 From Previous Versions
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/contributing/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/latest/contributing/">Contributing</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/contributing/documentation-updates/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/contributing/documentation-updates/">
            Updating Documentation
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/contributing/issues/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/contributing/issues/">
            Submitting Issues
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/latest/contributing/pull-requests/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/latest/contributing/pull-requests/">
            Submitting Pull Requests
          </a>
        </div>
    </li>
        </ul>
    </li>




      <hr><nav id="TableOfContents"></nav>



      <section>
      </section>
    </ul>
  </aside>
  <section class="page">

    <div class="nav-select">
      <center>Navigation :
        <select onchange="javascript:location.href = this.value;">
          
    <option value="/quickstart/" >
   Quickstart</option>
    <option value="/architecture/" >
   Architecture</option>
    <option value="/configuration/" >
   Configuration</option>
    <option value="/installation/" >
   Installation</option>
    <option value="/pgo-client/" >
   Using the pgo Client</option>
    <option value="/security/" >
   RBAC Configuration</option>
    <option value="/advanced/" >
   Advanced Topics</option> 
      <option value="/advanced/custom-config/" >- Custom Configuration</option>
      <option value="/advanced/custom-config-ssl/" >- Custom SSL Configuration</option>
      <option value="/advanced/multi-zone-design-considerations/"  selected>- Multi-Zone Cloud Considerations</option>
      <option value="/advanced/direct-api-calls/" >- Rest API</option>
  
    <option value="/upgrade/" >
   Upgrade</option>
    <option value="/contributing/" >
   Contributing</option>



        </select>
      </center>
    </div>

    
      <div id="top-bar">
        
          
          
          
        <div id="top-github-link">
          <a class="github-link" href="https://crunchydata.github.io/postgres-operator/latest/contributing/" target="blank">
            <i class="fa fa-info-circle"></i>
            
          </a>
          <a class="github-link" href="https://github.com/CrunchyData/postgres-operator/edit/develop/hugo/content/advanced/multi-zone-design-considerations.md" target="blank">
            <i class="fa fa-code-fork"></i>
            
          </a>
        </div><div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
            <span id="sidebar-toggle-span">
              <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                <i class="fa fa-bars"></i>
              </a>
            </span>
            <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
            <span class="links">
            







 <a href='https://crunchydata.github.io/postgres-operator/latest/'>Crunchy PostgreSQL Operator</a> > <a href='https://crunchydata.github.io/postgres-operator/latest/advanced/'>Advanced Topics</a> > Multi-Zone Cloud Considerations

 

 


            </span>
        </div>

      </div>
    

    
    <div id="body-inner">

    <h1>Multi-Zone Cloud Considerations</h1>

    

    
    

<h2 id="considerations-for-postgresql-operator-deployments-in-multi-zone-cloud-environments">Considerations for PostgreSQL Operator Deployments in Multi-Zone Cloud Environments</h2>

<h4 id="overview">Overview</h4>

<p>When using the PostgreSQL Operator in a Kubernetes cluster consisting of nodes that span multiple zones, special consideration
must be taken to ensure all pods and the associated volumes re scheduled and provisioned within the same zone.</p>

<p>Given that a pod is unable mount a volume that is located in another zone, any volumes that are dynamically provisioned must
be provisioned in a topology-aware manner according to the specific scheduling requirements for the pod.</p>

<p>This means that when a new PostgreSQL cluster is created, it is necessary to ensure that the volume containing the database
files for the primary PostgreSQL database within the PostgreSQL clluster is provisioned in the same zone as the node containing the PostgreSQL primary pod that will be accesing the applicable volume.</p>

<h4 id="dynamic-provisioning-of-volumes-default-behavoir">Dynamic Provisioning of Volumes: Default Behavoir</h4>

<p>By default, the Kubernetes scheduler will ensure any pods created that claim a specific volume via a PVC are scheduled on a
node in the same zone as that volume.  This is part of the default Kubernetes <a href="https://kubernetes.io/docs/setup/multiple-zones/">multi-zone support</a>.</p>

<p>However, when using Kubernetes <a href="https://kubernetes.io/docs/concepts/storage/dynamic-provisioning/">dynamic provisioning</a>,
volumes are not provisioned in a topology-aware manner.</p>

<p>More specifically, when using dynamnic provisioning, volumes wills not be provisioned according to the same scheduling
requirements that will be placed on the pod that will be using it (e.g. it will not consider node selectors, resource
requirements, pod affinity/anti-affinity, and various other scheduling requirements).  Rather, PVCs are immediately bound as
soon as they are requested, which means volumes are provisioned without knowledge of these scheduling requirements.</p>

<p>This behavior defined using the <code>volumeBindingMode</code> configuration applicable to the Storage Class being utilized to
dynamically provision the volume.  By default,<code>volumeBindingMode</code> is set to <code>Immediate</code>.</p>

<p>This default behavoir for dynamic provisioning can be seen in the Storage Class definition for a Google Cloud Engine Persistent Disk (GCE PD):</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kind: StorageClass
apiVersion: storage.k8s.io/v1
metadata:
  name: example-sc
provisioner: kubernetes.io/gce-pd
parameters:
  type: pd-standard
volumeBindingMode: Immediate</code></pre></div>
<p>As indicated, <code>volumeBindingMode</code> indicates the default value of <code>Immediate</code>.</p>

<h4 id="issues-with-dynamic-provisioning-of-volumes-in-postgresql-operator">Issues with Dynamic Provisioning of Volumes in PostgreSQL Operator</h4>

<p>Unfortunately, the default setting for dynamic provisinoing of volumes in mulit-zone Kubernetes cluster environments results in undesired behavoir when using the PostgreSQL Operator.</p>

<p>Within the PostgreSQL Operator, a <strong>node label</strong> is implemented as a <code>preferredDuringSchedulingIgnoredDuringExecution</code> node
affinity rule, which is an affinity rule that Kubernetes will attempt to adhere to when scheduling any pods for the cluster,
but <em>will not guarantee</em>. More information on node affinity rules can be found <a href="https://kubernetes.i/docs/concepts/configuration/assign-pod-node/#affinity-and-anti-affinity">here</a>).</p>

<p>By using <code>Immediate</code> for the <code>volumeBindingMode</code> in a multi-zone cluster environment, the scheduler will ignore any requested
<em>(but not mandatory)</em> scheduling requirements if necessary to ensure the pod can be scheduled. The scheduler will ultimately
schedule the pod on a node in the same zone as the volume, even if another node was requested for scheduling that pod.</p>

<p>As it relates to the PostgreSQL Operator specifically, a node label specified using the <code>--node-label</code> option when creating a
cluster using the <code>pgo create cluster</code> command in order target a specific node (or nodes) for the deployment of that cluster.</p>

<p>Therefore, if the volume ends up in a zone other than the zone containing the node (or nodes) defined by the node label, the
node label will be ignored, and the pod will be scheduled according to the zone containing the volume.</p>

<h4 id="configuring-volumes-to-be-topology-aware">Configuring Volumes to be Topology Aware</h4>

<p>In order to overcome this default behavior, it is necessary to make the dynamically provisioned volumes topology aware.</p>

<p>This is accomplished by setting the <code>volumeBindingMode</code> for the storage class to <code>WaitForFirstConsumer</code>, which delays the
dynamic provisioning of a volume until a pod using it is created.</p>

<p>In other words, the PVC is no longer bound as soon as it is requested, but rather waits for a pod utilizing it to be creating
prior to binding.  This change ensures that volume can take into account the scheduling requirements for the pod, which in the
case of a multi-zone cluster means ensuring the volume is provisioned in the same zone containing the node where the pod has
be scheduled.  This also means the scheduler should no longer ignore a node label in order to follow a volume to another zone
when scheduling a pod, since the volume will now follow the pod according to the pods specificscheduling requirements.</p>

<p>The following is an example of the the same Storage Class defined above, only with <code>volumeBindingMode</code> now set to <code>WaitForFirstConsumer</code>:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kind: StorageClass
apiVersion: storage.k8s.io/v1
metadata:
  name: example-sc
provisioner: kubernetes.io/gce-pd
parameters:
  type: pd-standard
volumeBindingMode: WaitForFirstConsumer</code></pre></div>
<h4 id="additional-solutions">Additional Solutions</h4>

<p>If you are using a version of Kubernetes that does not support <code>WaitForFirstConsumer</code>, an alternate <em>(and now deprecated)</em>
solution exists in the form of parameters that can be defined on the Storage Class definition to ensure volumes are
provisioned in a specific zone (or zones).</p>

<p>For instance, when defining a Storage Class for a GCE PD for use in Google Kubernetes Engine (GKE) cluster, the <strong>zone</strong>
parameter can be used to ensure any volumes dynamically provisioned using that Storage Class are located in that specific
zone.  The following is an example of a Storage Class for a GKE cluster that will provision volumes in the <strong>us-east1</strong> zone:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kind: StorageClass
apiVersion: storage.k8s.io/v1
metadata:
  name: example-sc
provisioner: kubernetes.io/gce-pd
parameters:
  type: pd-standard
  replication-type: none
  zone: us-east1</code></pre></div>
<p>Once storage classes have been defined for one or more zones, they can then be defined as one or more storage configurations
within the pgo.yaml configuration file (as described in the <a href="https://crunchydata.github.io/postgres-operator/latest/configuration/pgo-yaml
configuration">PGO YAML configuration guide</a>).</p>

<p>From there those storage configurations can then be selected when creating a new cluster, as shown in the following example:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">pgo create cluster mycluster --storage-config<span style="color:#f92672">=</span>example-sc</code></pre></div>
<p>With this approach, the pod will once again be scheduled according to the zone in which the volume was provisioned.</p>

<p>However, the zone parameters defined on the Storage Class bring consistency to scheduling by guaranteeing that the volume, and
therefore also the pod using that volume, are scheduled in a specific zone as defined by the user, bringing consistency
and predictability to volume provisioning and pod scheduling in multi-zone clusters.</p>

<p>For more information regarding the specific parameters available for the Storage Classes being utilizing in your cloud
environment, please see the
<a href="https://kubernetes.io/docs/concepts/storage/storage-classes/">Kubernetes documentation for Storage Classes</a>.</p>

<p>Lastly, while the above applies to the dynamic provisioning of volumes, it should be noted that volumes can also be manually
provisioned in desired zones in order to achieve the desired topology requirements for any pods and their volumes.</p>



    
        <div class="chevrons">
    <div id="navigation">
<a class="nav nav-prev" href="https://crunchydata.github.io/postgres-operator/latest/advanced/custom-config-ssl/" title="Custom SSL Configuration"> <i class="fa fa-chevron-left"></i><label>Custom SSL Configuration</label></a>
    <a class="nav nav-next" href="https://crunchydata.github.io/postgres-operator/latest/advanced/direct-api-calls/" title="Rest API" style="margin-right: 0px;"><label>Rest API</label><i class="fa fa-chevron-right"></i></a></div>
  </div>

  </section>
</article>

<footer>

<div class="footline">
    

    

  

  </div>


	<div>
	</div>
</footer>

<link href="https://crunchydata.github.io/postgres-operator/latest/css/featherlight.min.css" rel="stylesheet">
<script src="https://crunchydata.github.io/postgres-operator/latest/js/featherlight.min.js"></script>

<script src="https://crunchydata.github.io/postgres-operator/latest/theme-flex/script.js"></script>


    

    
    

    
  </body>
</html>
