<!DOCTYPE html>
<html>
  <head>
    
    <title>Crunchy Data PostgreSQL Operator Documentation</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="generator" content="Hugo 0.55.6" />
<title>Installing Metrics Infrastructure :: Crunchy Data PostgreSQL Operator Documentation</title>
<link rel="shortcut icon" href="https://crunchydata.github.io/postgres-operator/stable/favicon.png" type="image/x-icon" />
<link href="https://crunchydata.github.io/postgres-operator/stable/css/nucleus.css" rel="stylesheet">
<link href="https://crunchydata.github.io/postgres-operator/stable/theme-flex/style.css" rel="stylesheet">

<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
<link href="https://crunchydata.github.io/postgres-operator/stable/css/Fort-Fonts.css" rel="stylesheet">
<link href="https://crunchydata.github.io/postgres-operator/stable/css/custom.css" rel="stylesheet">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
<script src="https://crunchydata.github.io/postgres-operator/stable/js/jquery-2.x.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.bundle.min.js" integrity="sha384-zDnhMsjVZfS3hiP7oCBRmfjkQC4fzxVxFhBx8Hkz2aZX8gEvA/jsP3eXRCvzTofP" crossorigin="anonymous"></script>
<script src="https://crunchydata.github.io/postgres-operator/stable/js/main.js"></script>
<script src="https://crunchydata.github.io/postgres-operator/stable/js/toc.js"></script>
<script type="text/javascript">
      var baseurl = "https:\/\/crunchydata.github.io\/postgres-operator\/stable";
</script>
<meta name="description" content="">



    
  </head>
  <body data-url="/installation/install-with-ansible/installing-metrics/">
    
      <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
  
<a class="navbar-brand" href="https://www.crunchydata.com/"><img alt="Crunchy Data" src="https://crunchydata.github.io/postgres-operator/stable/images/logo.svg"></a>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <ul class="navbar-nav mr-auto"></ul>
  <span class="navbar-text">
      <nav class="shortcuts">
              <li class="" role="">
                  <a href="https://github.com/CrunchyData/postgres-operator" target="_blank" rel="noopener">
                    <i class='fab fa-github'></i> <label>Source</label>
                  </a>
              </li>
              <li class="" role="">
                  <a href="https://kubernetes.io/docs/" target="_blank" rel="noopener">
                    <i class='fas fa-bookmark'></i> <label>Kubernetes</label>
                  </a>
              </li>
              <li class="" role="">
                  <a href="https://github.com/CrunchyData/postgres-operator/blob/master/LICENSE.md" target="_blank" rel="noopener">
                    <i class='fas fa-file-contract'></i> <label>License</label>
                  </a>
              </li>
      </nav>
  </span>
</nav>

<article>
  <aside>

    <ul class="menu">
      <div>
        <div class="searchbox">
          <input data-search-input id="search-by" type="text" placeholder="">
        </div>
        <script type="text/javascript" src="https://crunchydata.github.io/postgres-operator/stable/js/lunr.min.js"></script>
        <script type="text/javascript" src="https://crunchydata.github.io/postgres-operator/stable/js/auto-complete.js"></script>
        <link href="https://crunchydata.github.io/postgres-operator/stable/css/auto-complete.css" rel="stylesheet">
        <script type="text/javascript">
          
              var baseurl = "https:\/\/crunchydata.github.io\/postgres-operator\/stable";
          
        </script>
        <script type="text/javascript" src="https://crunchydata.github.io/postgres-operator/stable/js/search.js"></script>
      </div>

      <hr>
      <a class="baselink" href="https://crunchydata.github.io/postgres-operator/stable/">Crunchy Data PostgreSQL Operator Documentation</a>
      <hr>
        <b>Available Formats</b>
        <nav class="downloads">
                <li class="" role="">
                    <a href="https://crunchydata.github.io/postgres-operator/stable/pdf/postgres_operator.pdf" target="_blank" rel="noopener">
                      <i class='fas fa-file-pdf'></i> <label>PDF</label>
                    </a>
                </li>
                <li class="" role="">
                    <a href="https://crunchydata.github.io/postgres-operator/stable/epub/postgres_operator.epub" target="_blank" rel="noopener">
                      <i class='fas fa-book'></i> <label>EPUB</label>
                    </a>
                </li>
        </nav>
        <hr>

      <b>Navigation</b>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/quickstart/" class="dd-item
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/stable/quickstart/">Quickstart</a>

      </div>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/architecture/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/stable/architecture/">Architecture</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/architecture/overview/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/architecture/overview/">
            Overview
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/architecture/provisioning/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/architecture/provisioning/">
            Provisioning
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/architecture/disaster-recovery/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/architecture/disaster-recovery/">
            Disaster Recovery
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/architecture/high-availability/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/architecture/high-availability/">
            High-Availability
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/architecture/namespace/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/architecture/namespace/">
            Namespace Management
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/architecture/eventing/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/architecture/eventing/">
            Lifecycle Events
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/architecture/postgres-operator-containers-overview/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/architecture/postgres-operator-containers-overview/">
            PostgreSQL Containers
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/architecture/storage-overview/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/architecture/storage-overview/">
            Storage
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/architecture/users-role-overview/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/architecture/users-role-overview/">
            User &amp; Roles
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/configuration/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/stable/configuration/">Configuration</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/configuration/compatibility/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/configuration/compatibility/">
            Compatibility Requirements
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/configuration/configuration/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/configuration/configuration/">
            Configuration Resources
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/configuration/pgo-yaml-configuration/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/configuration/pgo-yaml-configuration/">
            PGO YAML
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/configuration/tls/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/configuration/tls/">
            TLS
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/installation/" class="dd-item parent haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/stable/installation/">Installation</a>
            <i class="fas fa-angle-down fa-lg category-icon"></i>

      </div>
        <ul>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/installation/prereq/" class="dd-item
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/stable/installation/prereq/">Prerequisites</a>

      </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/installation/common-env/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/installation/common-env/">
            Operator Environment
          </a>
        </div>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/installation/install-with-ansible/" class="dd-item parent haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/stable/installation/install-with-ansible/">Install Operator Using Ansible</a>
            <i class="fas fa-angle-down fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/installation/install-with-ansible/prerequisites/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/installation/install-with-ansible/prerequisites/">
            Prerequisites
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/installation/install-with-ansible/installing-ansible/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/installation/install-with-ansible/installing-ansible/">
            Installing Ansible
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/installation/install-with-ansible/installing-operator/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/installation/install-with-ansible/installing-operator/">
            Installing PostgreSQL Operator
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/installation/install-with-ansible/installing-metrics/" class="dd-item active">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/installation/install-with-ansible/installing-metrics/">
            Installing Metrics Infrastructure
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/installation/install-with-ansible/updating-operator/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/installation/install-with-ansible/updating-operator/">
            Updating PostgreSQL Operator
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/installation/install-with-ansible/uninstalling-operator/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/installation/install-with-ansible/uninstalling-operator/">
            Uninstalling PostgreSQL Operator
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/installation/install-with-ansible/uninstalling-metrics/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/installation/install-with-ansible/uninstalling-metrics/">
            Uninstalling Metrics Stack
          </a>
        </div>
    </li>
        </ul>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/installation/operator-install/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/installation/operator-install/">
            Install Operator Using Bash
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/installation/developer-setup/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/installation/developer-setup/">
            Developer Setup
          </a>
        </div>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/installation/install-pgo-client/" class="dd-item
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/stable/installation/install-pgo-client/">Install `pgo` Client</a>

      </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/">Using the pgo Client</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/common-tasks/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/common-tasks/">
            Common pgo Client Tasks
          </a>
        </div>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/">pgo Client Reference</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_apply/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_apply/">
            pgo apply
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_backup/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_backup/">
            pgo backup
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_benchmark/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_benchmark/">
            pgo benchmark
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_cat/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_cat/">
            pgo cat
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_clone/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_clone/">
            pgo clone
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_create/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_create/">
            pgo create
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_create_cluster/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_create_cluster/">
            pgo create cluster
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_create_namespace/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_create_namespace/">
            pgo create namespace
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_create_pgbouncer/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_create_pgbouncer/">
            pgo create pgbouncer
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_create_pgorole/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_create_pgorole/">
            pgo create pgorole
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_create_pgouser/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_create_pgouser/">
            pgo create pgouser
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_create_policy/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_create_policy/">
            pgo create policy
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_create_schedule/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_create_schedule/">
            pgo create schedule
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_create_user/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_create_user/">
            pgo create user
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_delete/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_delete/">
            pgo delete
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_delete_backup/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_delete_backup/">
            pgo delete backup
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_delete_benchmark/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_delete_benchmark/">
            pgo delete benchmark
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_delete_cluster/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_delete_cluster/">
            pgo delete cluster
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_delete_label/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_delete_label/">
            pgo delete label
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_delete_namespace/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_delete_namespace/">
            pgo delete namespace
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_delete_pgbouncer/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_delete_pgbouncer/">
            pgo delete pgbouncer
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_delete_pgorole/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_delete_pgorole/">
            pgo delete pgorole
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_delete_pgouser/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_delete_pgouser/">
            pgo delete pgouser
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_delete_policy/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_delete_policy/">
            pgo delete policy
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_delete_schedule/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_delete_schedule/">
            pgo delete schedule
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_delete_user/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_delete_user/">
            pgo delete user
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_df/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_df/">
            pgo df
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_failover/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_failover/">
            pgo failover
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_label/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_label/">
            pgo label
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_load/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_load/">
            pgo load
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_ls/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_ls/">
            pgo ls
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_reload/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_reload/">
            pgo reload
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_restore/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_restore/">
            pgo restore
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_scale/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_scale/">
            pgo scale
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_scaledown/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_scaledown/">
            pgo scaledown
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_show/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_show/">
            pgo show
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_show_backup/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_show_backup/">
            pgo show backup
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_show_benchmark/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_show_benchmark/">
            pgo show benchmark
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_show_cluster/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_show_cluster/">
            pgo show cluster
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_show_config/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_show_config/">
            pgo show config
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_show_namespace/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_show_namespace/">
            pgo show namespace
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_show_pgorole/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_show_pgorole/">
            pgo show pgorole
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_show_pgouser/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_show_pgouser/">
            pgo show pgouser
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_show_policy/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_show_policy/">
            pgo show policy
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_show_pvc/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_show_pvc/">
            pgo show pvc
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_show_schedule/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_show_schedule/">
            pgo show schedule
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_show_user/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_show_user/">
            pgo show user
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_show_workflow/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_show_workflow/">
            pgo show workflow
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_status/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_status/">
            pgo status
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_test/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_test/">
            pgo test
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_update/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_update/">
            pgo update
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_update_cluster/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_update_cluster/">
            pgo update cluster
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_update_namespace/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_update_namespace/">
            pgo update namespace
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_update_pgorole/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_update_pgorole/">
            pgo update pgorole
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_update_pgouser/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_update_pgouser/">
            pgo update pgouser
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_update_user/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_update_user/">
            pgo update user
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_upgrade/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_upgrade/">
            pgo upgrade
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_version/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_version/">
            pgo version
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_watch/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/pgo-client/reference/pgo_watch/">
            pgo watch
          </a>
        </div>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/security/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/stable/security/">RBAC Configuration</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/security/configure-postgres-operator-rbac/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/security/configure-postgres-operator-rbac/">
            Configuration of PostgreSQL Operator RBAC
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/security/install-postgres-operator-rbac/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/security/install-postgres-operator-rbac/">
            Installation of PostgreSQL Operator RBAC
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/security/api-encryption-configuration/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/security/api-encryption-configuration/">
            PostgreSQL Operator API Encryption Configuration
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/advanced/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/stable/advanced/">Advanced Topics</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/advanced/custom-config/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/advanced/custom-config/">
            Custom Configuration
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/advanced/custom-config-ssl/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/advanced/custom-config-ssl/">
            Custom SSL Configuration
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/advanced/multi-zone-design-considerations/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/advanced/multi-zone-design-considerations/">
            Multi-Zone Cloud Considerations
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/advanced/direct-api-calls/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/advanced/direct-api-calls/">
            Rest API
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/upgrade/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/stable/upgrade/">Upgrade</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/upgrade/upgrade35/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/upgrade/upgrade35/">
            Upgrade PGO 3.5 Minor Versions
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/upgrade/upgrade35to4/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/upgrade/upgrade35to4/">
            Upgrade PGO 3.5 to 4.2.1
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/upgrade/upgrade4xto42_ansible/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/upgrade/upgrade4xto42_ansible/">
            Upgrade PGO 4.X to 4.2.1 (Ansible)
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/upgrade/upgrade4xto42_bash/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/upgrade/upgrade4xto42_bash/">
            Upgrade PGO 4.X to 4.2.1 (Bash)
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/upgrade/upgrade41/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/upgrade/upgrade41/">
            Upgrade PostgreSQL Operator 4.1 Minor Versions
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/upgrade/upgradeto35/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/upgrade/upgradeto35/">
            Upgrade to PGO 3.5 From Previous Versions
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/contributing/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/postgres-operator/stable/contributing/">Contributing</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/contributing/documentation-updates/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/contributing/documentation-updates/">
            Updating Documentation
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/contributing/issues/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/contributing/issues/">
            Submitting Issues
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/postgres-operator/stable/contributing/pull-requests/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/postgres-operator/stable/contributing/pull-requests/">
            Submitting Pull Requests
          </a>
        </div>
    </li>
        </ul>
    </li>




      <hr><nav id="TableOfContents"></nav>



      <section>
      </section>
    </ul>
  </aside>
  <section class="page">

    <div class="nav-select">
      <center>Navigation :
        <select onchange="javascript:location.href = this.value;">
          
    <option value="/quickstart/" >
   Quickstart</option>
    <option value="/architecture/" >
   Architecture</option>
    <option value="/configuration/" >
   Configuration</option>
    <option value="/installation/" >
   Installation</option> 
    <option value="/installation/prereq/" >
  - 
   Prerequisites</option>
      <option value="/installation/common-env/" >- Operator Environment</option>
    <option value="/installation/install-with-ansible/" >
  - 
   Install Operator Using Ansible</option> 
      <option value="/installation/install-with-ansible/prerequisites/" >-- Prerequisites</option>
      <option value="/installation/install-with-ansible/installing-ansible/" >-- Installing Ansible</option>
      <option value="/installation/install-with-ansible/installing-operator/" >-- Installing PostgreSQL Operator</option>
      <option value="/installation/install-with-ansible/installing-metrics/"  selected>-- Installing Metrics Infrastructure</option>
      <option value="/installation/install-with-ansible/updating-operator/" >-- Updating PostgreSQL Operator</option>
      <option value="/installation/install-with-ansible/uninstalling-operator/" >-- Uninstalling PostgreSQL Operator</option>
      <option value="/installation/install-with-ansible/uninstalling-metrics/" >-- Uninstalling Metrics Stack</option>
  
      <option value="/installation/operator-install/" >- Install Operator Using Bash</option>
      <option value="/installation/developer-setup/" >- Developer Setup</option>
    <option value="/installation/install-pgo-client/" >
  - 
   Install `pgo` Client</option>
  
    <option value="/pgo-client/" >
   Using the pgo Client</option>
    <option value="/security/" >
   RBAC Configuration</option>
    <option value="/advanced/" >
   Advanced Topics</option>
    <option value="/upgrade/" >
   Upgrade</option>
    <option value="/contributing/" >
   Contributing</option>



        </select>
      </center>
    </div>

    
      <div id="top-bar">
        
          
          
          
        <div id="top-github-link">
          <a class="github-link" href="https://crunchydata.github.io/postgres-operator/stable/contributing/" target="blank">
            <i class="fa fa-info-circle"></i>
            
          </a>
          <a class="github-link" href="https://github.com/CrunchyData/postgres-operator/edit/develop/hugo/content/Installation/install-with-ansible/installing-metrics.md" target="blank">
            <i class="fa fa-code-fork"></i>
            
          </a>
        </div><div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
            <span id="sidebar-toggle-span">
              <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                <i class="fa fa-bars"></i>
              </a>
            </span>
            <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
            <span class="links">
            










 <a href='https://crunchydata.github.io/postgres-operator/stable/'>Crunchy PostgreSQL Operator</a> > <a href='https://crunchydata.github.io/postgres-operator/stable/installation/'>Installation</a> > <a href='https://crunchydata.github.io/postgres-operator/stable/installation/install-with-ansible/'>Install Operator Using Ansible</a> > Installing Metrics Infrastructure

 

 

 


            </span>
        </div>

      </div>
    

    
    <div id="body-inner">

    <h1>Installing Metrics Infrastructure</h1>

    

    
    

<h1 id="installing">Installing</h1>

<p>PostgreSQL clusters created by the Crunchy PostgreSQL Operator can optionally be
configured to serve performance metrics via Prometheus Exporters.  The metric exporters
included in the database pod serve realtime metrics for the database container.  In
order to store and view this data, Grafana and Prometheus are required.  The Crunchy
PostgreSQL Operator does not create this infrastructure, however, they can be installed
using the provided Ansible roles.</p>

<h2 id="prerequisites">Prerequisites</h2>

<p>The following assumes the proper <a href="https://crunchydata.github.io/postgres-operator/stable/installation/install-with-ansible/prerequisites/">prerequisites are satisfied</a>
we can now install the PostgreSQL Operator.</p>

<p>At a minimum, the following inventory variables should be configured to install the
metrics infrastructure:</p>

<table>
<thead>
<tr>
<th>Name</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td><code>ccp_image_prefix</code></td>
<td>crunchydata</td>
<td>Configures the image prefix used when creating containers from Crunchy Container Suite.</td>
</tr>

<tr>
<td><code>ccp_image_tag</code></td>
<td></td>
<td>Configures the image tag (version) used when creating containers from Crunchy Container Suite.</td>
</tr>

<tr>
<td><code>grafana_admin_username</code></td>
<td>admin</td>
<td>Set to configure the login username for the Grafana administrator.</td>
</tr>

<tr>
<td><code>grafana_admin_password</code></td>
<td></td>
<td>Set to configure the login password for the Grafana administrator.</td>
</tr>

<tr>
<td><code>grafana_install</code></td>
<td>true</td>
<td>Set to true to install Crunchy Grafana to visualize metrics.</td>
</tr>

<tr>
<td><code>grafana_storage_access_mode</code></td>
<td></td>
<td>Set to the access mode used by the configured storage class for Grafana persistent volumes.</td>
</tr>

<tr>
<td><code>grafana_storage_class_name</code></td>
<td></td>
<td>Set to the name of the storage class used when creating Grafana persistent volumes.</td>
</tr>

<tr>
<td><code>grafana_volume_size</code></td>
<td></td>
<td>Set to the size of persistent volume to create for Grafana.</td>
</tr>

<tr>
<td><code>kubernetes_context</code></td>
<td></td>
<td>When deploying to Kubernetes, set to configure the context name of the kubeconfig to be used for authentication.</td>
</tr>

<tr>
<td><code>metrics</code></td>
<td>false</td>
<td>Set to true enable performance metrics on all newly created clusters.  This can be disabled by the client.</td>
</tr>

<tr>
<td><code>metrics_namespace</code></td>
<td>metrics</td>
<td>Configures the target namespace when deploying Grafana and/or Prometheus</td>
</tr>

<tr>
<td><code>openshift_host</code></td>
<td></td>
<td>When deploying to OpenShift, set to configure the hostname of the OpenShift cluster to connect to.</td>
</tr>

<tr>
<td><code>openshift_password</code></td>
<td></td>
<td>When deploying to OpenShift, set to configure the password used for login.</td>
</tr>

<tr>
<td><code>openshift_skip_tls_verify</code></td>
<td></td>
<td>When deploying to Openshift, set to ignore the integrity of TLS certificates for the OpenShift cluster.</td>
</tr>

<tr>
<td><code>openshift_token</code></td>
<td></td>
<td>When deploying to OpenShift, set to configure the token used for login (when not using username/password authentication).</td>
</tr>

<tr>
<td><code>openshift_user</code></td>
<td></td>
<td>When deploying to OpenShift, set to configure the username used for login.</td>
</tr>

<tr>
<td><code>prometheus_install</code></td>
<td>true</td>
<td>Set to true to install Crunchy Prometheus timeseries database.</td>
</tr>

<tr>
<td><code>prometheus_storage_access_mode</code></td>
<td></td>
<td>Set to the access mode used by the configured storage class for Prometheus persistent volumes.</td>
</tr>

<tr>
<td><code>prometheus_storage_class_name</code></td>
<td></td>
<td>Set to the name of the storage class used when creating Prometheus persistent volumes.</td>
</tr>
</tbody>
</table>

<div class="notices tip" >Administrators can choose to install Grafana, Prometheus or both by configuring the
<code>grafana_install</code> and <code>prometheus_install</code> variables in the inventory files.</div>

<p>The following commands should be run in the directory where the Crunchy PostgreSQL Operator
playbooks are located.  See the <code>ansible</code> directory in the Crunchy PostgreSQL Operator
project for the inventory file, main playbook and ansible roles.</p>

<div class="notices tip" >At this time the Crunchy PostgreSQL Operator Playbooks only support storage classes.
For more information on storage classes see the <a href="https://kubernetes.io/docs/concepts/storage/storage-classes/">official Kubernetes documentation</a>.</div>

<h2 id="installing-on-linux">Installing on Linux</h2>

<p>On a Linux host with Ansible installed we can run the following command to install
the Metrics stack:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ansible-playbook -i /path/to/inventory --tags<span style="color:#f92672">=</span>install-metrics main.yml</code></pre></div>
<p>If the Crunchy PostgreSQL Operator playbooks were installed using <code>yum</code>, use the
following commands:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#111">export</span> <span style="color:#111">ANSIBLE_ROLES_PATH</span><span style="color:#f92672">=</span>/usr/share/ansible/roles/crunchydata

ansible-playbook -i /path/to/inventory --tags<span style="color:#f92672">=</span>install-metrics --ask-become-pass <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>    /usr/share/ansible/postgres-operator/playbooks/main.yml</code></pre></div>
<h2 id="installing-on-macos">Installing on MacOS</h2>

<p>On a MacOS host with Ansible installed we can run the following command to install
the Metrics stack:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ansible-playbook -i /path/to/inventory --tags<span style="color:#f92672">=</span>install-metrics main.yml</code></pre></div>
<h2 id="installing-on-windows">Installing on Windows</h2>

<p>On a Windows host with the Ubuntu subsystem we can run the following commands to install
the Metrics stack:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ansible-playbook -i /path/to/inventory --tags<span style="color:#f92672">=</span>install-metrics main.yml</code></pre></div>
<h2 id="verifying-the-installation">Verifying the Installation</h2>

<p>This may take a few minutes to deploy.  To check the status of the deployment run
the following:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Kubernetes</span>
kubectl get deployments -n &lt;NAMESPACE_NAME&gt;
kubectl get pods -n &lt;NAMESPACE_NAME&gt;

<span style="color:#75715e"># OpenShift</span>
oc get deployments -n &lt;NAMESPACE_NAME&gt;
oc get pods -n &lt;NAMESPACE_NAME&gt;</code></pre></div>
<h2 id="verify-grafana">Verify Grafana</h2>

<p>In a separate terminal we need to setup a port forward to the Crunchy Grafana deployment
to ensure connection can be made outside of the cluster:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># If deployed to Kubernetes</span>
kubectl port-forward &lt;GRAFANA_POD_NAME&gt; -n &lt;METRICS_NAMESPACE&gt; <span style="color:#ae81ff">3000</span>:3000

<span style="color:#75715e"># If deployed to OpenShift</span>
oc port-forward &lt;GRAFANA_POD_NAME&gt; -n &lt;METRICS_NAMESPACE&gt; <span style="color:#ae81ff">3000</span>:3000</code></pre></div>
<p>In a browser navigate to <code>http://127.0.0.1:3000</code> to access the Grafana dashboard.</p>

<div class="notices tip" ><p>No metrics will be scraped if no exporters are available.  To create a PostgreSQL
cluster with metric exporters run the following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">pgo create cluster &lt;NAME OF CLUSTER&gt; --metrics --namespace<span style="color:#f92672">=</span>&lt;NAMESPACE&gt;</code></pre></div></div>

<h2 id="verify-prometheus">Verify Prometheus</h2>

<p>In a separate terminal we need to setup a port forward to the Crunchy Prometheus deployment
to ensure connection can be made outside of the cluster:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># If deployed to Kubernetes</span>
kubectl port-forward &lt;PROMETHEUS_POD_NAME&gt; -n &lt;METRICS_NAMESPACE&gt; <span style="color:#ae81ff">9090</span>:9090

<span style="color:#75715e"># If deployed to OpenShift</span>
oc port-forward &lt;PROMETHEUS_POD_NAME&gt; -n &lt;METRICS_NAMESPACE&gt; <span style="color:#ae81ff">9090</span>:9090</code></pre></div>
<p>In a browser navigate to <code>http://127.0.0.1:9090</code> to access the Prometheus dashboard.</p>

<div class="notices tip" ><p>No metrics will be scraped if no exporters are available.  To create a PostgreSQL
cluster with metric exporters run the following command:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">pgo create cluster &lt;NAME OF CLUSTER&gt; --metrics --namespace<span style="color:#f92672">=</span>&lt;NAMESPACE&gt;</code></pre></div></div>



    
        <div class="chevrons">
    <div id="navigation">
<a class="nav nav-prev" href="https://crunchydata.github.io/postgres-operator/stable/installation/install-with-ansible/installing-operator/" title="Installing PostgreSQL Operator"> <i class="fa fa-chevron-left"></i><label>Installing PostgreSQL Operator</label></a>
    <a class="nav nav-next" href="https://crunchydata.github.io/postgres-operator/stable/installation/install-with-ansible/updating-operator/" title="Updating PostgreSQL Operator" style="margin-right: 0px;"><label>Updating PostgreSQL Operator</label><i class="fa fa-chevron-right"></i></a></div>
  </div>

  </section>
</article>

<footer>

<div class="footline">
    

    

  

  </div>


	<div>
	</div>
</footer>

<link href="https://crunchydata.github.io/postgres-operator/stable/css/featherlight.min.css" rel="stylesheet">
<script src="https://crunchydata.github.io/postgres-operator/stable/js/featherlight.min.js"></script>

<script src="https://crunchydata.github.io/postgres-operator/stable/theme-flex/script.js"></script>


    

    
    

    
  </body>
</html>
